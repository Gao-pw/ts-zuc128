const e=(e,t)=>(e<<t|e>>>32-t)>>>0,t=new Uint8Array([62,114,91,71,202,224,0,51,4,209,84,152,9,185,109,203,123,27,249,50,175,157,106,165,184,45,252,29,8,83,3,144,77,78,132,153,228,206,217,145,221,182,133,72,139,41,110,172,205,193,248,30,115,67,105,198,181,189,253,57,99,32,212,56,118,125,178,167,207,237,87,197,243,44,187,20,33,6,85,155,227,239,94,49,79,127,90,164,13,130,81,73,95,186,88,28,74,22,213,23,168,146,36,31,140,255,216,174,46,1,211,173,59,75,218,70,235,201,222,154,143,135,215,58,128,111,47,200,177,180,55,247,10,34,19,40,124,204,60,137,199,195,150,86,7,191,126,240,11,43,151,82,53,65,121,97,166,76,16,254,188,38,149,136,138,176,163,251,192,24,148,242,225,229,233,93,208,220,17,102,100,92,236,89,66,117,18,245,116,156,170,35,14,134,171,190,42,2,231,103,230,68,162,108,194,147,159,241,246,250,54,210,80,104,158,98,113,21,61,214,64,196,226,15,204,12,19,236,95,151,68,23,196,167,125,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219]),n=new Uint8Array([110,212,122,34,62,108,91,126,203,5,75,9,28,106,26,157,80,239,96,17,63,251,85,86,242,56,98,181,25,27,53,200,114,155,49,61,186,112,105,144,160,137,14,9,142,85,52,27,59,26,131,100,103,129,125,102,74,151,100,111,15,55,107,237,8,58,140,71,137,201,126,139,99,138,94,31,11,57,46,73,159,28,1,39,125,95,155,106,98,145,10,57,90,4,25,15,6,131,38,105,12,43,83,159,107,62,145,90,41,57,109,148,115,11,158,52,27,119,78,73,110,48,137,105,181,45,101,7,128,57,59,67,39,7,109,9,113,110,27,159,107,71,125,95,31,59,26,131,100,103,129,125,102,74,151,100,111,15,55,107,237,8,58,140,71,137,201,126,139,99,138,94,31,11,57,46,73,159,28,1,39,125,95,155,106,98,145,10,57,90,4,25,15,6,131,38,105,12,43,83,159,107,62,145,90,41,57,109,148,115,11,158,52,27,119,78,73,110,48,137,105,181,45,101,7,128,57,59,67,39,7,109,9,113,110,27,159,107,71,125,95,31,59,26,131,100,103,129,125,102,74,151,100,111,15,55,107,237,8,58,140,71,137,201,126,139,99,138,94,31,11,57,46,73,159,28,1,39,125,95,155,106,98,145,10,57,90,4,25,15,6,131,38,105,12,43,83,159,107,62,145,90,41,57,109,148,115,11,158,52,27,119,78,73,110,48,137,105,181,45,101,7,128,57,59,67,39,7,109,9,113,110,27,159,107,71,125,95,31,59,26,131,100,103,129,125,102,74,151,100,111,15,55,107,237,8,58,140,71,137,201,126,139,99,138,94,31,11,57,46,73,159,28,1,39,125,95,155,106,98,145,10,57,90,4,25,15,6,131,38,105,12,43,83,159,107,62,145,90,41,57,109,148,115,11,158,52,27,119,78,73,110,48,137,105,181,45,101,7,128,57,59,67,39,7,109,9,113,110,27,159,107,71,125,95,31]);var r={S0:t,S1:n};const{S0:i,S1:a}=r;var o=class t{static use(e){return e(t)}s=Array(16);r1=0;r2=0;constructor(e,t){if(e.length!==16||t.length!==16)throw Error(`ZUC-128 需要 16 B 密钥 + 16 B IV`);this.init(e,t)}init(e,t){let n=[17623,9916,25195,4958,22409,13794,28981,2479,19832,12051,27588,6897,24102,15692,18344,1069];for(let r=0;r<16;r++){let i=e[r]<<8|t[r];this.s[r]=i^n[r]}for(let e=0;e<32;e++)this.bitReconstruction(),this.f(),this.lfsrWithInitialisationMode(this.r1>>>1)}bitReconstruction(){let e=this.s,t=(e[15]<<16|e[14]>>>15)>>>0,n=(e[11]<<16|e[9]>>>15)>>>0,r=(e[7]<<16|e[5]>>>15)>>>0,i=(e[3]<<16|e[1]>>>15)>>>0;return[t,n,r,i]}f(){let[t,n,,r]=this.bitReconstruction(),o=(t^this.r1)>>>0,s=this.r2,c=(this.r1^n)>>>0,l=i[o>>>24]<<24|a[o>>>16&255]<<16|i[o>>>8&255]<<8|a[o&255],u=e(l,8)^c,d=e(u,16)^s;return this.r1=(e(r<<8,9)^d)>>>0,this.r2=u>>>0,this.r1}lfsrWithInitialisationMode(e){let t=this.s,n=(t[0]&2147483647)>>>0;for(let e=0;e<15;e++)t[e]=t[e+1];t[15]=(n^e)>>>0}lfsrWithWorkMode(){let e=this.s;this.f();let t=(e[0]&2147483647)>>>0;for(let t=0;t<15;t++)e[t]=e[t+1];e[15]=t>>>0}nextWord(){this.lfsrWithWorkMode();let e=this.f()^this.bitReconstruction()[3];return e>>>0}crypt(e){let t=new Uint8Array(e.length),n=0;for(;n+4<=e.length;){let r=this.nextWord(),i=new DataView(t.buffer,n);i.setUint32(0,r,!1);for(let r=0;r<4;r++)t[n+r]^=e[n+r];n+=4}for(;n<e.length;){let r=this.nextWord()>>>24-(n&3)*8&255;t[n]=e[n]^r,n++}return t}};export{o as ZUC128};